#!/usr/bin/env ruby

require 'optparse'
require 'methadone'
require 'rsyncbackup'

class App
  include Methadone::Main
  include Methadone::CLILogging

  main do |source, target|
    syncer = Rsyncbackup.new(source, target, options)
    syncer.run
    syncer.finalize
  end

  description "Yet another rsync backup script, this time in ruby"

  on("-e FILE","--exclusions","Exclusions file")
  on("-d","--dry-run","Mark this as a dry run (or not)")
  on("--verbose","Be chatty")
  on("--debug","show debug stuff")

  arg :source, "Source to backup from"
  arg :target, "Target backup directory"

  version Rsyncbackup::VERSION

  # use_log_level_option

  go!
end
